<!DOCTYPE html>
<html>
  <head><meta charset="utf-8">
    <link href="report.css" rel="stylesheet">
    
    <title>report_sample</title>
    <meta name="description" content="Report"></head>
  <body>
  

    




















<h1 id="cover">如何使用Jupyter撰写分析报告</h1>
<address>本本教育（北京）科技有限公司</address>
<testdate>2019年11月</testdate>





<h2 id="&#21069;&#35328;">&#21069;&#35328;<a class="anchor-link" href="#&#21069;&#35328;">&#182;</a></h2>

<blockquote><p>Jupyter Notebook是基于网页的用于交互计算的应用程序，其可被应用于全过程计算：开发、文档编写、运行代码和展示结果。</p>

<pre><code>                                                                      ——Jupyter Notebook官方介绍</code></pre>
</blockquote>


<p>简而言之，Jupyter Notebook是以网页的形式打开，可以在网页页面中直接编写和运行代码，代码的运行结果也会直接在代码块下显示。如在编程过程中需要编写说明文档，可在同一个页面中直接编写，便于作及时的说明和解释。</p>
<p>基于Jupyter具备富文档和标准化的特性，我们也希望可以利用它生成美观的数据分析报告。<strong>SmartyDoc</strong>就是为此而生。</p>
<p>利用<strong>SmartyDoc</strong>提供的转化工具，我们可以将包含图文的Jupyter Notebook文件转存为具备一定层次结构的html文件，配合适当的css文件以及<strong>weasyprint</strong>工具，即可产生PDF格式的报告文档。</p>
<p>下面将具体介绍如何利用这套工具撰写报告文档。</p>


<h2 id="&#35774;&#35745;&#25253;&#21578;&#30340;&#23618;&#32423;&#32467;&#26500;">&#35774;&#35745;&#25253;&#21578;&#30340;&#23618;&#32423;&#32467;&#26500;<a class="anchor-link" href="#&#35774;&#35745;&#25253;&#21578;&#30340;&#23618;&#32423;&#32467;&#26500;">&#182;</a></h2>

<p>在本框架内，文档的层级结构基于<em>Heading</em>实现，即报告的题目为一级标题，用 <code># 报告题目</code> 这种形式实现，各个章节的标题为二级标题，用 <code>## 章节标题</code> 的形式实现，以下可以继续出现三级、四级...等不同等级的章节。</p>
<p>在撰写报告时，报告题目的样式以一段程序自动生成，用户只需提供报告封面的内容即可，具体可以参考 <em>Cell 5</em> 中的内容。需要用户自己写的报告章节结构，以二级标题为最高层级。</p>
<p>在每个章节下，可以出现文字、表格和图片等信息。</p>


<h2 id="&#20316;&#22270;&#25351;&#21335;">&#20316;&#22270;&#25351;&#21335;<a class="anchor-link" href="#&#20316;&#22270;&#25351;&#21335;">&#182;</a></h2>

<h3 id="&#20351;&#29992;&#30340;&#24037;&#20855;&#21253;">&#20351;&#29992;&#30340;&#24037;&#20855;&#21253;<a class="anchor-link" href="#&#20351;&#29992;&#30340;&#24037;&#20855;&#21253;">&#182;</a></h3>

<p>为了得到美观且样式丰富的数据图，这里建议主要使用<em>plotly</em>工具包作图，并将图片保存为SVG格式，以保证在不同设备和缩放尺度下的图片质量。</p>
<p>对于一些非常具有设计感但难以通过<em>plotly</em>简单实现的图片，可以使用<em>svgutils</em>工具包中的图片组合功能，手动对图片进行重组和编辑。</p>
<p>具体使用样例请参考下面的示例。</p>


<h3 id="&#33258;&#21160;&#28155;&#21152;&#22270;&#34920;&#32534;&#21495;">&#33258;&#21160;&#28155;&#21152;&#22270;&#34920;&#32534;&#21495;<a class="anchor-link" href="#&#33258;&#21160;&#28155;&#21152;&#22270;&#34920;&#32534;&#21495;">&#182;</a></h3>

<p>在撰写报告时会产生大量的图片，要准确标注每张图的编号将会消耗很大的人力，因此我们将这项工作交给程序自动完成。</p>
<p>在<strong>SmartyDoc</strong>中的<code>decorator</code>工具包中，提供了<code>FigCounter</code>类用来对图表编号进行自动计数。这个类的初始化方法请见 <em>Cell 2</em>，在初始化时需要提供图表名称的起始词，如图1，图2，...中的"图"字，以及设置文字的字号和字体等。初始化后，具体的使用方法请参考下文的示例。</p>


<h2 id="&#19968;&#20123;&#31034;&#20363;">&#19968;&#20123;&#31034;&#20363;<a class="anchor-link" href="#&#19968;&#20123;&#31034;&#20363;">&#182;</a></h2>

<h3 id="&#22312;&#25253;&#21578;&#20013;&#26174;&#31034;&#22270;&#29255;">&#22312;&#25253;&#21578;&#20013;&#26174;&#31034;&#22270;&#29255;<a class="anchor-link" href="#&#22312;&#25253;&#21578;&#20013;&#26174;&#31034;&#22270;&#29255;">&#182;</a></h3>








<div id="img"><img src="imgs/common/jupyter_home.png" alt="image"></div>






<h3 id="&#21033;&#29992;Plotly&#30011;&#25968;&#23383;&#34920;-1">&#21033;&#29992;Plotly&#30011;&#25968;&#23383;&#34920; 1<a class="anchor-link" href="#&#21033;&#29992;Plotly&#30011;&#25968;&#23383;&#34920;-1">&#182;</a></h3>








<div id="img"><img src="imgs/sample12345/img1.svg" alt="image"></div>






<h3 id="&#21033;&#29992;Plotly&#30011;&#25968;&#23383;&#34920;-2">&#21033;&#29992;Plotly&#30011;&#25968;&#23383;&#34920; 2<a class="anchor-link" href="#&#21033;&#29992;Plotly&#30011;&#25968;&#23383;&#34920;-2">&#182;</a></h3>








<div id="img"><img src="imgs/sample12345/img2.svg" alt="image"></div>






<h3 id="&#21033;&#29992;Plotly&#30011;&#38647;&#36798;&#22270;">&#21033;&#29992;Plotly&#30011;&#38647;&#36798;&#22270;<a class="anchor-link" href="#&#21033;&#29992;Plotly&#30011;&#38647;&#36798;&#22270;">&#182;</a></h3>








<div id="img"><img src="imgs/sample12345/img3.svg" alt="image"></div>






<h3 id="&#21033;&#29992;svgutils&#24037;&#20855;&#21253;&#36827;&#34892;&#22270;&#29255;&#32452;&#21512;">&#21033;&#29992;svgutils&#24037;&#20855;&#21253;&#36827;&#34892;&#22270;&#29255;&#32452;&#21512;<a class="anchor-link" href="#&#21033;&#29992;svgutils&#24037;&#20855;&#21253;&#36827;&#34892;&#22270;&#29255;&#32452;&#21512;">&#182;</a></h3>








<div id="img"><img src="imgs/sample12345/general_report_final.svg" alt="image"></div>






<h3 id="&#22312;&#20195;&#30721;&#20013;&#25171;&#21360;&#25991;&#23383;">&#22312;&#20195;&#30721;&#20013;&#25171;&#21360;&#25991;&#23383;<a class="anchor-link" href="#&#22312;&#20195;&#30721;&#20013;&#25171;&#21360;&#25991;&#23383;">&#182;</a></h3>






<p>Print sentences within your code ... The score is 78
</p>




<h3 id="&#20351;&#29992;html&#21576;&#29616;&#34920;&#26684;">&#20351;&#29992;html&#21576;&#29616;&#34920;&#26684;<a class="anchor-link" href="#&#20351;&#29992;html&#21576;&#29616;&#34920;&#26684;">&#182;</a></h3>











<table border="1">
<thead>
<tr>
<th>学校名称</th>
<th>总人数</th>
<th>男生</th>
<th>女生</th>
<th>班级数</th>
</tr>
</thead>
<tfoot>
<tr>
<td>合计</td>
<td>270人</td>
<td>160人</td>
<td>110人</td>
<td>21</td>
</tr>
</tfoot>
<tbody>
<tr>
<td>A学校</td>
<td>100人</td>
<td>60人</td>
<td>40人</td>
<td>10</td>
</tr>
<tr>
<td>B学校</td>
<td>90人</td>
<td>30人</td>
<td>60人</td>
<td>15</td>
</tr>
<tr>
<td>C学校</td>
<td>80人</td>
<td>70人</td>
<td>10人</td>
<td>6</td>
</tr>
<tr>
<td>105</td>
<td>157</td>
<td>20</td>
<td>65</td>
<td>102</td>
</tr>
<tr>
<td>183</td>
<td>150</td>
<td>19</td>
<td>166</td>
<td>199</td>
</tr>
<tr>
<td>29</td>
<td>126</td>
<td>171</td>
<td>68</td>
<td>90</td>
</tr>
<tr>
<td>159</td>
<td>183</td>
<td>23</td>
<td>50</td>
<td>90</td>
</tr>
<tr>
<td>80</td>
<td>108</td>
<td>102</td>
<td>197</td>
<td>93</td>
</tr>
<tr>
<td>178</td>
<td>35</td>
<td>93</td>
<td>70</td>
<td>198</td>
</tr>
<tr>
<td>67</td>
<td>121</td>
<td>41</td>
<td>109</td>
<td>62</td>
</tr>
<tr>
<td>128</td>
<td>23</td>
<td>13</td>
<td>16</td>
<td>27</td>
</tr>
<tr>
<td>159</td>
<td>27</td>
<td>185</td>
<td>156</td>
<td>176</td>
</tr>
<tr>
<td>38</td>
<td>52</td>
<td>93</td>
<td>10</td>
<td>65</td>
</tr>
<tr>
<td>137</td>
<td>157</td>
<td>53</td>
<td>14</td>
<td>111</td>
</tr>
<tr>
<td>146</td>
<td>28</td>
<td>46</td>
<td>154</td>
<td>110</td>
</tr>
<tr>
<td>120</td>
<td>118</td>
<td>112</td>
<td>162</td>
<td>61</td>
</tr>
<tr>
<td>73</td>
<td>32</td>
<td>144</td>
<td>17</td>
<td>52</td>
</tr>
<tr>
<td>49</td>
<td>66</td>
<td>99</td>
<td>141</td>
<td>30</td>
</tr>
<tr>
<td>86</td>
<td>22</td>
<td>122</td>
<td>158</td>
<td>105</td>
</tr>
<tr>
<td>82</td>
<td>71</td>
<td>148</td>
<td>177</td>
<td>29</td>
</tr>
<tr>
<td>191</td>
<td>50</td>
<td>67</td>
<td>76</td>
<td>128</td>
</tr>
<tr>
<td>42</td>
<td>82</td>
<td>43</td>
<td>28</td>
<td>61</td>
</tr>
<tr>
<td>53</td>
<td>156</td>
<td>180</td>
<td>137</td>
<td>120</td>
</tr>
<tr>
<td>128</td>
<td>173</td>
<td>108</td>
<td>164</td>
<td>95</td>
</tr>
<tr>
<td>12</td>
<td>74</td>
<td>16</td>
<td>111</td>
<td>92</td>
</tr>
<tr>
<td>19</td>
<td>100</td>
<td>97</td>
<td>118</td>
<td>155</td>
</tr>
<tr>
<td>84</td>
<td>21</td>
<td>111</td>
<td>106</td>
<td>35</td>
</tr>
<tr>
<td>37</td>
<td>163</td>
<td>91</td>
<td>79</td>
<td>12</td>
</tr>
<tr>
<td>67</td>
<td>60</td>
<td>91</td>
<td>165</td>
<td>30</td>
</tr>
<tr>
<td>158</td>
<td>176</td>
<td>139</td>
<td>38</td>
<td>104</td>
</tr>
<tr>
<td>132</td>
<td>174</td>
<td>92</td>
<td>43</td>
<td>107</td>
</tr>
<tr>
<td>196</td>
<td>159</td>
<td>190</td>
<td>171</td>
<td>144</td>
</tr>
<tr>
<td>12</td>
<td>58</td>
<td>117</td>
<td>112</td>
<td>195</td>
</tr>
<tr>
<td>79</td>
<td>56</td>
<td>200</td>
<td>116</td>
<td>141</td>
</tr>
<tr>
<td>121</td>
<td>52</td>
<td>123</td>
<td>192</td>
<td>156</td>
</tr>
<tr>
<td>67</td>
<td>33</td>
<td>33</td>
<td>80</td>
<td>52</td>
</tr>
<tr>
<td>57</td>
<td>113</td>
<td>194</td>
<td>158</td>
<td>166</td>
</tr>
<tr>
<td>154</td>
<td>120</td>
<td>98</td>
<td>168</td>
<td>164</td>
</tr>
<tr>
<td>171</td>
<td>23</td>
<td>170</td>
<td>177</td>
<td>32</td>
</tr>
<tr>
<td>115</td>
<td>41</td>
<td>198</td>
<td>158</td>
<td>129</td>
</tr>
<tr>
<td>170</td>
<td>49</td>
<td>147</td>
<td>76</td>
<td>27</td>
</tr>
<tr>
<td>123</td>
<td>181</td>
<td>164</td>
<td>67</td>
<td>169</td>
</tr>
<tr>
<td>89</td>
<td>198</td>
<td>20</td>
<td>142</td>
<td>149</td>
</tr>
<tr>
<td>191</td>
<td>115</td>
<td>26</td>
<td>197</td>
<td>134</td>
</tr>
<tr>
<td>77</td>
<td>140</td>
<td>47</td>
<td>49</td>
<td>159</td>
</tr>
<tr>
<td>113</td>
<td>38</td>
<td>14</td>
<td>87</td>
<td>142</td>
</tr>
<tr>
<td>54</td>
<td>108</td>
<td>32</td>
<td>87</td>
<td>73</td>
</tr>
<tr>
<td>192</td>
<td>118</td>
<td>106</td>
<td>82</td>
<td>119</td>
</tr>
<tr>
<td>93</td>
<td>20</td>
<td>32</td>
<td>61</td>
<td>95</td>
</tr>
<tr>
<td>66</td>
<td>11</td>
<td>43</td>
<td>118</td>
<td>192</td>
</tr>
<tr>
<td>153</td>
<td>10</td>
<td>51</td>
<td>113</td>
<td>199</td>
</tr>
<tr>
<td>37</td>
<td>121</td>
<td>41</td>
<td>147</td>
<td>70</td>
</tr>
<tr>
<td>66</td>
<td>37</td>
<td>94</td>
<td>20</td>
<td>22</td>
</tr>
<tr>
<td>148</td>
<td>17</td>
<td>153</td>
<td>60</td>
<td>69</td>
</tr>
<tr>
<td>194</td>
<td>115</td>
<td>91</td>
<td>74</td>
<td>104</td>
</tr>
<tr>
<td>177</td>
<td>59</td>
<td>55</td>
<td>123</td>
<td>149</td>
</tr>
<tr>
<td>72</td>
<td>186</td>
<td>41</td>
<td>69</td>
<td>131</td>
</tr>
<tr>
<td>46</td>
<td>40</td>
<td>168</td>
<td>105</td>
<td>166</td>
</tr>
<tr>
<td>194</td>
<td>40</td>
<td>128</td>
<td>92</td>
<td>89</td>
</tr>
<tr>
<td>160</td>
<td>48</td>
<td>107</td>
<td>95</td>
<td>196</td>
</tr>
<tr>
<td>82</td>
<td>149</td>
<td>181</td>
<td>51</td>
<td>62</td>
</tr>
<tr>
<td>43</td>
<td>40</td>
<td>100</td>
<td>178</td>
<td>61</td>
</tr>
<tr>
<td>180</td>
<td>179</td>
<td>81</td>
<td>188</td>
<td>183</td>
</tr>
<tr>
<td>126</td>
<td>96</td>
<td>36</td>
<td>186</td>
<td>20</td>
</tr>
<tr>
<td>60</td>
<td>178</td>
<td>149</td>
<td>82</td>
<td>200</td>
</tr>
<tr>
<td>34</td>
<td>119</td>
<td>117</td>
<td>27</td>
<td>124</td>
</tr>
<tr>
<td>143</td>
<td>144</td>
<td>26</td>
<td>64</td>
<td>61</td>
</tr>
<tr>
<td>57</td>
<td>161</td>
<td>80</td>
<td>170</td>
<td>180</td>
</tr>
<tr>
<td>200</td>
<td>89</td>
<td>69</td>
<td>16</td>
<td>69</td>
</tr>
<tr>
<td>197</td>
<td>23</td>
<td>192</td>
<td>119</td>
<td>19</td>
</tr>
<tr>
<td>20</td>
<td>106</td>
<td>182</td>
<td>45</td>
<td>34</td>
</tr>
<tr>
<td>12</td>
<td>131</td>
<td>199</td>
<td>153</td>
<td>99</td>
</tr>
<tr>
<td>190</td>
<td>147</td>
<td>34</td>
<td>95</td>
<td>90</td>
</tr>
<tr>
<td>76</td>
<td>103</td>
<td>129</td>
<td>165</td>
<td>131</td>
</tr>
<tr>
<td>25</td>
<td>96</td>
<td>70</td>
<td>143</td>
<td>159</td>
</tr>
<tr>
<td>138</td>
<td>118</td>
<td>128</td>
<td>84</td>
<td>171</td>
</tr>
<tr>
<td>194</td>
<td>121</td>
<td>167</td>
<td>59</td>
<td>120</td>
</tr>
<tr>
<td>39</td>
<td>46</td>
<td>192</td>
<td>40</td>
<td>88</td>
</tr>
<tr>
<td>177</td>
<td>171</td>
<td>166</td>
<td>114</td>
<td>58</td>
</tr>
<tr>
<td>155</td>
<td>19</td>
<td>138</td>
<td>22</td>
<td>93</td>
</tr>
<tr>
<td>180</td>
<td>58</td>
<td>19</td>
<td>94</td>
<td>45</td>
</tr>
<tr>
<td>96</td>
<td>147</td>
<td>13</td>
<td>118</td>
<td>57</td>
</tr>
<tr>
<td>89</td>
<td>29</td>
<td>200</td>
<td>19</td>
<td>156</td>
</tr>
<tr>
<td>175</td>
<td>37</td>
<td>49</td>
<td>31</td>
<td>123</td>
</tr>
<tr>
<td>17</td>
<td>138</td>
<td>99</td>
<td>183</td>
<td>181</td>
</tr>
<tr>
<td>74</td>
<td>115</td>
<td>68</td>
<td>51</td>
<td>99</td>
</tr>
<tr>
<td>52</td>
<td>72</td>
<td>21</td>
<td>23</td>
<td>96</td>
</tr>
<tr>
<td>31</td>
<td>103</td>
<td>161</td>
<td>44</td>
<td>167</td>
</tr>
<tr>
<td>14</td>
<td>130</td>
<td>143</td>
<td>77</td>
<td>97</td>
</tr>
<tr>
<td>101</td>
<td>79</td>
<td>24</td>
<td>28</td>
<td>22</td>
</tr>
<tr>
<td>10</td>
<td>57</td>
<td>90</td>
<td>50</td>
<td>153</td>
</tr>
<tr>
<td>149</td>
<td>177</td>
<td>50</td>
<td>10</td>
<td>113</td>
</tr>
<tr>
<td>198</td>
<td>123</td>
<td>96</td>
<td>97</td>
<td>113</td>
</tr>
<tr>
<td>110</td>
<td>145</td>
<td>76</td>
<td>53</td>
<td>88</td>
</tr>
<tr>
<td>14</td>
<td>171</td>
<td>26</td>
<td>158</td>
<td>155</td>
</tr>
<tr>
<td>70</td>
<td>46</td>
<td>86</td>
<td>87</td>
<td>176</td>
</tr>
<tr>
<td>174</td>
<td>80</td>
<td>188</td>
<td>32</td>
<td>140</td>
</tr>
<tr>
<td>102</td>
<td>14</td>
<td>148</td>
<td>160</td>
<td>20</td>
</tr>
<tr>
<td>103</td>
<td>34</td>
<td>71</td>
<td>74</td>
<td>157</td>
</tr>
<tr>
<td>84</td>
<td>21</td>
<td>84</td>
<td>177</td>
<td>42</td>
</tr>
<tr>
<td>57</td>
<td>35</td>
<td>185</td>
<td>136</td>
<td>63</td>
</tr>
<tr>
<td>184</td>
<td>12</td>
<td>75</td>
<td>110</td>
<td>77</td>
</tr>
<tr>
<td>48</td>
<td>160</td>
<td>13</td>
<td>138</td>
<td>140</td>
</tr>
</tbody>
</table>








  </body>
</html>
